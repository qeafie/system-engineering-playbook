<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
     width="1400" height="1200" viewBox="0 0 1400 1200">
  
  <!-- Стили -->
  <defs>
    <style>
      .pool { fill: #E8F5E9; stroke: #2E7D32; stroke-width: 2; }
      .pool-label { font-family: Arial; font-size: 14px; font-weight: bold; fill: #2E7D32; }
      .task { fill: #FFF; stroke: #000; stroke-width: 1.5; rx: 10; ry: 10; }
      .task-text { font-family: Arial; font-size: 11px; fill: #000; text-anchor: middle; }
      .gateway { fill: #FFFFCC; stroke: #000; stroke-width: 1.5; }
      .gateway-text { font-family: Arial; font-size: 10px; fill: #000; text-anchor: middle; }
      .event-start { fill: #FFF; stroke: #000; stroke-width: 1; }
      .event-end { fill: #000; stroke: #000; stroke-width: 3; }
      .event-timer { fill: #FFF; stroke: #000; stroke-width: 1; }
      .sequence-flow { fill: none; stroke: #000; stroke-width: 1.5; marker-end: url(#arrowhead); }
      .message-flow { fill: none; stroke: #000; stroke-width: 1.5; stroke-dasharray: 5,5; marker-end: url(#arrowhead-white); }
    </style>
    
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#000" />
    </marker>
    <marker id="arrowhead-white" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#FFF" stroke="#000" stroke-width="1"/>
    </marker>
  </defs>
  
  <!-- Заголовок -->
  <text x="700" y="30" style="font-family: Arial; font-size: 18px; font-weight: bold; text-anchor: middle;">
    BPMN: Процесс обеспечения соответствия 152-ФЗ
  </text>
  
  <!-- Пул 1: Управление согласиями -->
  <rect class="pool" x="50" y="60" width="1300" height="200"/>
  <text class="pool-label" x="60" y="85" transform="rotate(-90 60 85)">Управление согласиями</text>
  
  <circle class="event-start" cx="120" cy="160" r="18"/>
  <text class="task-text" x="120" y="200" style="font-size: 10px;">Новые ПДн</text>
  
  <rect class="task" x="180" y="130" width="110" height="60"/>
  <text class="task-text" x="235" y="155">Предоставить</text>
  <text class="task-text" x="235" y="170">форму согласия</text>
  
  <rect class="task" x="330" y="130" width="110" height="60"/>
  <text class="task-text" x="385" y="155">Объяснить</text>
  <text class="task-text" x="385" y="170">цели обработки</text>
  
  <g transform="translate(490, 160) rotate(45)">
    <rect class="gateway" x="-22" y="-22" width="44" height="44"/>
  </g>
  <text class="gateway-text" x="490" y="210">Согласие?</text>
  
  <rect class="task" x="550" y="130" width="110" height="60"/>
  <text class="task-text" x="605" y="155">Верифицировать</text>
  <text class="task-text" x="605" y="170">ЭЦП</text>
  
  <rect class="task" x="700" y="130" width="110" height="60"/>
  <text class="task-text" x="755" y="155">Сохранить</text>
  <text class="task-text" x="755" y="170">в реестр</text>
  
  <rect class="task" x="850" y="130" width="110" height="60"/>
  <text class="task-text" x="905" y="155">Назначить срок</text>
  <text class="task-text" x="905" y="170">хранения</text>
  
  <circle class="event-end" cx="1020" cy="160" r="18"/>
  <circle class="event-end" cx="1020" cy="160" r="14" fill="#FFF"/>
  
  <circle class="event-end" cx="490" cy="80" r="18"/>
  <circle class="event-end" cx="490" cy="80" r="14" fill="#FFF"/>
  <text class="task-text" x="490" y="60" style="font-size: 10px;">Отказ</text>
  
  <!-- Потоки -->
  <line class="sequence-flow" x1="138" y1="160" x2="180" y2="160"/>
  <line class="sequence-flow" x1="290" y1="160" x2="330" y2="160"/>
  <line class="sequence-flow" x1="440" y1="160" x2="468" y2="160"/>
  <line class="sequence-flow" x1="512" y1="160" x2="550" y2="160"/>
  <line class="sequence-flow" x1="660" y1="160" x2="700" y2="160"/>
  <line class="sequence-flow" x1="810" y1="160" x2="850" y2="160"/>
  <line class="sequence-flow" x1="960" y1="160" x2="1002" y2="160"/>
  <line class="sequence-flow" x1="490" y1="138" x2="490" y2="98"/>
  
  <!-- Пул 2: Обработка ПДн -->
  <rect class="pool" x="50" y="280" width="1300" height="260"/>
  <text class="pool-label" x="60" y="305" transform="rotate(-90 60 305)">Обработка ПДн</text>
  
  <circle class="event-start" cx="120" cy="410" r="18"/>
  
  <rect class="task" x="180" y="380" width="110" height="60"/>
  <text class="task-text" x="235" y="405">Зашифровать</text>
  <text class="task-text" x="235" y="420">(AES-256)</text>
  
  <rect class="task" x="330" y="380" width="110" height="60"/>
  <text class="task-text" x="385" y="405">Применить</text>
  <text class="task-text" x="385" y="420">политики</text>
  
  <g transform="translate(490, 410) rotate(45)">
    <rect class="gateway" x="-22" y="-22" width="44" height="44"/>
    <line x1="-10" y1="0" x2="10" y2="0" stroke="#000" stroke-width="2"/>
    <line x1="0" y1="-10" x2="0" y2="10" stroke="#000" stroke-width="2"/>
  </g>
  
  <rect class="task" x="540" y="340" width="110" height="50"/>
  <text class="task-text" x="595" y="365">Защищенное</text>
  <text class="task-text" x="595" y="378">хранилище</text>
  
  <rect class="task" x="540" y="400" width="110" height="50"/>
  <text class="task-text" x="595" y="425">Резервные</text>
  <text class="task-text" x="595" y="438">копии</text>
  
  <g transform="translate(700, 410) rotate(45)">
    <rect class="gateway" x="-22" y="-22" width="44" height="44"/>
    <line x1="-10" y1="0" x2="10" y2="0" stroke="#000" stroke-width="2"/>
    <line x1="0" y1="-10" x2="0" y2="10" stroke="#000" stroke-width="2"/>
  </g>
  
  <rect class="task" x="750" y="380" width="110" height="60"/>
  <text class="task-text" x="805" y="405">Регистрация</text>
  <text class="task-text" x="805" y="420">операций</text>
  
  <!-- Событие таймера для проверки сроков -->
  <circle class="event-timer" cx="920" cy="410" r="18"/>
  <circle class="event-timer" cx="920" cy="410" r="14"/>
  <text x="910" y="418" style="font-size: 16px;">⏰</text>
  <text class="task-text" x="920" y="450" style="font-size: 9px;">Проверка сроков</text>
  
  <g transform="translate(1000, 410) rotate(45)">
    <rect class="gateway" x="-22" y="-22" width="44" height="44"/>
  </g>
  <text class="gateway-text" x="1000" y="460">Срок истек?</text>
  
  <rect class="task" x="1060" y="380" width="110" height="60"/>
  <text class="task-text" x="1115" y="405">Инициировать</text>
  <text class="task-text" x="1115" y="420">удаление</text>
  
  <rect class="task" x="1000" y="310" width="100" height="50"/>
  <text class="task-text" x="1050" y="330">Продолжить</text>
  <text class="task-text" x="1050" y="343">хранение</text>
  
  <circle class="event-end" cx="1230" cy="410" r="18"/>
  <circle class="event-end" cx="1230" cy="410" r="14" fill="#FFF"/>
  
  <!-- Потоки -->
  <line class="sequence-flow" x1="138" y1="410" x2="180" y2="410"/>
  <line class="sequence-flow" x1="290" y1="410" x2="330" y2="410"/>
  <line class="sequence-flow" x1="440" y1="410" x2="468" y2="410"/>
  <line class="sequence-flow" x1="512" y1="410" x2="540" y2="365"/>
  <line class="sequence-flow" x1="512" y1="410" x2="540" y2="425"/>
  <line class="sequence-flow" x1="650" y1="365" x2="678" y2="388"/>
  <line class="sequence-flow" x1="650" y1="425" x2="678" y2="412"/>
  <line class="sequence-flow" x1="722" y1="410" x2="750" y2="410"/>
  <line class="sequence-flow" x1="860" y1="410" x2="902" y2="410"/>
  <line class="sequence-flow" x1="938" y1="410" x2="978" y2="410"/>
  <line class="sequence-flow" x1="1022" y1="410" x2="1060" y2="410"/>
  <line class="sequence-flow" x1="1000" y1="388" x2="1000" y2="360"/>
  <line class="sequence-flow" x1="1000" y1="310" x2="1050" y2="310"/>
  <line class="sequence-flow" x1="1050" y1="360" x2="1050" y2="380"/>
  <line class="sequence-flow" x1="1050" y1="380" x2="1100" y2="380"/>
  <line class="sequence-flow" x1="1100" y1="380" x2="1100" y2="410"/>
  <line class="sequence-flow" x1="1170" y1="410" x2="1212" y2="410"/>
  
  <!-- Пул 3: Запросы субъектов -->
  <rect class="pool" x="50" y="560" width="1300" height="220"/>
  <text class="pool-label" x="60" y="585" transform="rotate(-90 60 585)">Запросы субъектов</text>
  
  <circle class="event-start" cx="120" cy="670" r="18"/>
  <text class="task-text" x="120" y="710" style="font-size: 10px;">Запрос субъекта</text>
  
  <rect class="task" x="180" y="640" width="110" height="60"/>
  <text class="task-text" x="235" y="665">Верифицировать</text>
  <text class="task-text" x="235" y="680">личность</text>
  
  <g transform="translate(340, 670) rotate(45)">
    <rect class="gateway" x="-22" y="-22" width="44" height="44"/>
  </g>
  <text class="gateway-text" x="340" y="720">Тип запроса?</text>
  
  <rect class="task" x="400" y="590" width="100" height="50"/>
  <text class="task-text" x="450" y="610">Формировать</text>
  <text class="task-text" x="450" y="623">выписку</text>
  
  <rect class="task" x="400" y="650" width="100" height="50"/>
  <text class="task-text" x="450" y="670">Корректировать</text>
  <text class="task-text" x="450" y="683">данные</text>
  
  <rect class="task" x="400" y="710" width="100" height="50"/>
  <text class="task-text" x="450" y="730">Удалить</text>
  <text class="task-text" x="450" y="743">данные</text>
  
  <g transform="translate(550, 670) rotate(45)">
    <rect class="gateway" x="-22" y="-22" width="44" height="44"/>
  </g>
  
  <rect class="task" x="600" y="640" width="110" height="60"/>
  <text class="task-text" x="655" y="665">Логировать</text>
  <text class="task-text" x="655" y="680">запрос</text>
  
  <rect class="task" x="750" y="640" width="110" height="60"/>
  <text class="task-text" x="805" y="665">Контроль</text>
  <text class="task-text" x="805" y="680">сроков ответа</text>
  
  <circle class="event-end" cx="920" cy="670" r="18"/>
  <circle class="event-end" cx="920" cy="670" r="14" fill="#FFF"/>
  
  <!-- Потоки -->
  <line class="sequence-flow" x1="138" y1="670" x2="180" y2="670"/>
  <line class="sequence-flow" x1="290" y1="670" x2="318" y2="670"/>
  <line class="sequence-flow" x1="362" y1="670" x2="400" y2="615"/>
  <line class="sequence-flow" x1="362" y1="670" x2="400" y2="675"/>
  <line class="sequence-flow" x1="362" y1="670" x2="400" y2="735"/>
  <line class="sequence-flow" x1="500" y1="615" x2="528" y2="648"/>
  <line class="sequence-flow" x1="500" y1="675" x2="528" y2="670"/>
  <line class="sequence-flow" x1="500" y1="735" x2="528" y2="692"/>
  <line class="sequence-flow" x1="572" y1="670" x2="600" y2="670"/>
  <line class="sequence-flow" x1="710" y1="670" x2="750" y2="670"/>
  <line class="sequence-flow" x1="860" y1="670" x2="902" y2="670"/>
  
  <!-- Пул 4: Аудит и отчетность -->
  <rect class="pool" x="50" y="800" width="1300" height="280"/>
  <text class="pool-label" x="60" y="825" transform="rotate(-90 60 825)">Аудит и отчетность</text>
  
  <circle class="event-start" cx="120" cy="940" r="18"/>
  
  <rect class="task" x="180" y="910" width="110" height="60"/>
  <text class="task-text" x="235" y="935">Собрать</text>
  <text class="task-text" x="235" y="950">журналы</text>
  
  <g transform="translate(340, 940) rotate(45)">
    <rect class="gateway" x="-22" y="-22" width="44" height="44"/>
    <line x1="-10" y1="0" x2="10" y2="0" stroke="#000" stroke-width="2"/>
    <line x1="0" y1="-10" x2="0" y2="10" stroke="#000" stroke-width="2"/>
  </g>
  
  <rect class="task" x="390" y="880" width="100" height="50"/>
  <text class="task-text" x="440" y="900">Ежедневные</text>
  <text class="task-text" x="440" y="913">отчеты</text>
  
  <rect class="task" x="390" y="940" width="100" height="50"/>
  <text class="task-text" x="440" y="960">Выявление</text>
  <text class="task-text" x="440" y="973">аномалий</text>
  
  <rect class="task" x="390" y="1000" width="100" height="50"/>
  <text class="task-text" x="440" y="1020">Архивация</text>
  <text class="task-text" x="440" y="1033">логов</text>
  
  <g transform="translate(540, 940) rotate(45)">
    <rect class="gateway" x="-22" y="-22" width="44" height="44"/>
    <line x1="-10" y1="0" x2="10" y2="0" stroke="#000" stroke-width="2"/>
    <line x1="0" y1="-10" x2="0" y2="10" stroke="#000" stroke-width="2"/>
  </g>
  
  <g transform="translate(640, 940) rotate(45)">
    <rect class="gateway" x="-22" y="-22" width="44" height="44"/>
  </g>
  <text class="gateway-text" x="640" y="990">Проверка РКН?</text>
  
  <rect class="task" x="700" y="910" width="110" height="60"/>
  <text class="task-text" x="755" y="935">Формирование</text>
  <text class="task-text" x="755" y="950">отчетов РКН</text>
  
  <g transform="translate(860, 940) rotate(45)">
    <rect class="gateway" x="-22" y="-22" width="44" height="44"/>
  </g>
  <text class="gateway-text" x="860" y="990">Нарушение?</text>
  
  <rect class="task" x="920" y="910" width="110" height="60"/>
  <text class="task-text" x="975" y="935">Корректирующие</text>
  <text class="task-text" x="975" y="950">действия</text>
  
  <rect class="task" x="860" y="850" width="100" height="50"/>
  <text class="task-text" x="910" y="870">Подтверждение</text>
  <text class="task-text" x="910" y="883">соответствия</text>
  
  <circle class="event-end" cx="1100" cy="940" r="18"/>
  <circle class="event-end" cx="1100" cy="940" r="14" fill="#FFF"/>
  
  <circle class="event-end" cx="640" cy="1040" r="18"/>
  <circle class="event-end" cx="640" cy="1040" r="14" fill="#FFF"/>
  
  <!-- Потоки -->
  <line class="sequence-flow" x1="138" y1="940" x2="180" y2="940"/>
  <line class="sequence-flow" x1="290" y1="940" x2="318" y2="940"/>
  <line class="sequence-flow" x1="362" y1="940" x2="390" y2="905"/>
  <line class="sequence-flow" x1="362" y1="940" x2="390" y2="965"/>
  <line class="sequence-flow" x1="362" y1="940" x2="390" y2="1025"/>
  <line class="sequence-flow" x1="490" y1="905" x2="518" y2="918"/>
  <line class="sequence-flow" x1="490" y1="965" x2="518" y2="940"/>
  <line class="sequence-flow" x1="490" y1="1025" x2="518" y2="962"/>
  <line class="sequence-flow" x1="562" y1="940" x2="618" y2="940"/>
  <line class="sequence-flow" x1="662" y1="940" x2="700" y2="940"/>
  <line class="sequence-flow" x1="810" y1="940" x2="838" y2="940"/>
  <line class="sequence-flow" x1="882" y1="940" x2="920" y2="940"/>
  <line class="sequence-flow" x1="1030" y1="940" x2="1082" y2="940"/>
  <line class="sequence-flow" x1="860" y1="918" x2="860" y2="900"/>
  <line class="sequence-flow" x1="860" y1="850" x2="910" y2="850"/>
  <line class="sequence-flow" x1="910" y1="900" x2="910" y2="920"/>
  <line class="sequence-flow" x1="910" y1="920" x2="920" y2="920"/>
  <line class="sequence-flow" x1="640" y1="962" x2="640" y2="1022"/>
  
  <!-- Потоки сообщений между пулами -->
  <line class="message-flow" x1="1020" y1="178" x2="120" y2="392"/>
  <line class="message-flow" x1="1230" y1="428" x2="120" y2="652"/>
  <line class="message-flow" x1="920" y1="688" x2="120" y2="922"/>
  
  <!-- Легенда -->
  <g transform="translate(50, 1100)">
    <text style="font-family: Arial; font-size: 12px; font-weight: bold;">Легенда BPMN:</text>
    <circle cx="20" cy="30" r="10" fill="#FFF" stroke="#000" stroke-width="1"/>
    <text x="40" y="35" style="font-family: Arial; font-size: 10px;">Событие начала</text>
    
    <circle cx="170" cy="30" r="10" fill="#000" stroke="#000" stroke-width="3"/>
    <circle cx="170" cy="30" r="7" fill="#FFF"/>
    <text x="190" y="35" style="font-family: Arial; font-size: 10px;">Событие конца</text>
    
    <circle cx="320" cy="30" r="10" fill="#FFF" stroke="#000" stroke-width="1"/>
    <circle cx="320" cy="30" r="8"/>
    <text x="305" y="38" style="font-size: 12px;">⏰</text>
    <text x="340" y="35" style="font-family: Arial; font-size: 10px;">Событие таймера</text>
    
    <g transform="translate(490, 30) rotate(45)">
      <rect x="-10" y="-10" width="20" height="20" fill="#FFFFCC" stroke="#000" stroke-width="1"/>
    </g>
    <text x="510" y="35" style="font-family: Arial; font-size: 10px;">Исключающий шлюз</text>
    
    <g transform="translate(680, 30) rotate(45)">
      <rect x="-10" y="-10" width="20" height="20" fill="#FFFFCC" stroke="#000" stroke-width="1"/>
      <line x1="-5" y1="0" x2="5" y2="0" stroke="#000" stroke-width="1.5"/>
      <line x1="0" y1="-5" x2="0" y2="5" stroke="#000" stroke-width="1.5"/>
    </g>
    <text x="700" y="35" style="font-family: Arial; font-size: 10px;">Параллельный шлюз</text>
  </g>
  
</svg>